---
layout: default
title: Documentation - ConditionerJS
---

<section>

    <h1 id="introduction" class="title">Documentation</h1>

    <nav class="index">

        <ul>
            <li><a href="#setup">Setup</a></li>
            <li><a href="#module-outline">Module outline</a></li>
            <li>
                <a href="#config">Configuring modules</a>
                <ul>
                    <li><a href="#data-module">Linking a module</a></li>
                    <li><a href="#data-conditions">Setting conditions</a></li>
                    <li><a href="#data-options">Passing options</a></li>
                    <li><a href="#data-priority">Altering priorities</a></li>
                </ul>
            </li>
            <li>
                <a href="#api">JavaScript API</a>
                <ul>
                    <li><a href="#conditioner">Conditioner</a></li>
                    <li><a href="#node">Node</a></li>
                    <li><a href="#module-controller">ModuleController</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    {% include docs-setup.html %}

    <section>

        <h2 id="module-outline">Module outline</h2>

        <p>ConditionerJS does not force you to write your modules in a certain way. Only if you wan't to unload your modules or pass custom options does it expect certain properties an methods to be there.</p>

        <p>The following two basic module examples both contain an <code>unload</code> method and an <code>options</code> property. If your module will never be unloaded you can omit the unload method, the same goes for the options property.</p>

        <p>An outline of a very basic module returning a class:</p>

{% highlight javascript %}
define(function(){

    // specify constructor
    var exports = function(element,options) {
        // setup
    };

    // define (optional) default class options here
    exports.options = {
        'foo':'bar'
    };

    // define (optional) unload method
    exports.prototype.unload = function() {
        // restore
    };

    // expose
    return exports;
});{% endhighlight %}

        <p>Outline of a module returning an object:</p>

{% highlight javascript %}
define(function(){

    // specify object literal
    var exports = {

        // define (optional) default object options here
        options:{
            'foo':'bar'
        },

        // called when module is loaded
        load:function(element,options) {

            // setup

            // conditioner requires a returned object reference
            return this;
        },

        // define (optional) unload method
        unload:function() {
            // restore
        }
    };

    // expose
    return exports;
});{% endhighlight %}

        <p>Now you know how to define modules, let's see how you can link them to the DOM and bring ConditionerJS to load them.</p>

    </section>


    <section>

        <h2 id="config">Configuring modules</h2>

        <p>Configuring your <a href="http://requirejs.org/docs/api.html#define" target="_blank">RequireJS Modules</a> so ConditionerJS can load them is done through data attributes. The following sections guide you through the configuration of a typical module.</p>

        <nav class="sub">
            <ul>
                <li><a href="#data-module">Linking a module to the DOM</a></li>
                <li><a href="#data-conditions">Setting module conditions</a></li>
                <li><a href="#data-options">Passing options to a module</a></li>
                <li><a href="#data-priority">Altering load priority</a></li>
            </ul>
        </nav>

        {% include docs-module.html %}

        {% include docs-conditions.html %}

        {% include docs-options.html %}

        {% include docs-priorities.html %}

    </section>






    <section>

        <h2 id="api">JavaScript API</h2>

        <p>ConditionerJS consists of a group of publicly accessible JavaScript Classes. These Classes allow you to safely access modules once they've been parsed. The starting point to load modules is always the <code>conditioner</code> object of which there is only one instance.</p>

        <nav class="sub code">
            <ul>
                <li><a href="#conditioner">conditioner</a> : object</li>
                <li><a href="#node">Node</a> : Class</li>
                <li><a href="#module-controller">ModuleController</a> : Class</li>
            </ul>
        </nav>


        <section>

            <h3 class="code" id="conditioner">conditioner</h3>
            <p>Call <code>loadModules(document)</code> on the conditioner object to start loading the modules defined in the HTML document. Once this is done the conditioner will return the array of
                Nodes it found and will initialize them once they are ready.</p>

            <p>Each <a href="#node">Node</a> contains one or more ModuleControllers, for each Node only one <a href="#module-controller">ModuleController</a> can have an active
                <a href="#module-base">Module</a>.</p>

            <p>The following methods are available on the conditioner object.</p>

            <nav class="sub code">
                <ul>
                    <li><a href="#conditioner-set-options">setOptions(object)</a></li>
                    <li><a href="#conditioner-load-modules">loadModules(context)</a> &rarr; Array</li>
                    <li><a href="#conditioner-get-node">getNode(selector)</a> &rarr; <a href="#node">Node</a> | null</li>
                    <li><a href="#conditioner-get-nodes-all">getNodesAll(selector)</a> &rarr; Array</li>
                </ul>
            </nav>

            <p>The following properties are available on the conditioner object.</p>

            <nav class="sub code">
                <ul>
                    <li><a href="#conditioner-utils">Utils</a></li>
                    <li><a href="#conditioner-observer">Observer</a></li>
                </ul>
            </nav>

            <p>Utils contains a method called <code>mergeObjects</code> which allows you to merge two objects resulting in a third merged object. The Observer is a simple pub / sub implementation.</p>

            <p>It contains the following methods:</p>

            <dl>
                <dt><code>publish(obj,type,data)</code></dt>
                <dd>Use this method to publish events.</dd>

                <dt><code>subscribe(obj,type,callback)</code></dt>
                <dd>Use this method to subscribe / listen for published events</dd>

                <dt><code>unsubscribe(obj,type,callback)</code></dt>
                <dd>Use this method to stop listening.</dd>

            </dl>

            <h4 class="code" id="conditioner-set-options">setOptions</h4>
            <p>Allows defining of page level Module options and shortcuts to modules.</p>

{% highlight javascript %}/**
* Set conditioner options
* @param {object} options
* @public
*/
conditioner.setOptions({
    'modules':{
        'ui/Clock':'IClock',
        'ui/Map':{
            'alias':'IMap',
            'options':{
                'zoom':10
            }
        }
    }
});{% endhighlight %}



            <h4 class="code" id="conditioner-load-modules">loadModules</h4>
            <p>Finds and loads all Modules defined on child elements of the supplied context. Returns an array of found Nodes.</p>

{% highlight javascript %}/**
* Loads modules found within the given context
* @param {element} context - Context to search for modules
* @return {Array} - Array of found Nodes
*/
conditioner.loadModules(context);{% endhighlight %}



            <h4 class="code" id="conditioner-get-node">getNode</h4>
            <p>Returns a single Node matching the supplied selector.</p>
{% highlight javascript %}/**
* Returns the first Node matching the selector
* @param {string} selector - Selector to match the nodes to
* @return {Node} First matched node
*/
conditioner.getNode(selector);{% endhighlight %}



            <h4 class="code" id="conditioner-get-nodes-all">getNodesAll</h4>
            <p>Returns an Array of found Nodes matching the supplied selector.</p>
{% highlight javascript %}/**
* Returns all nodes matching the selector
* @param {string} selector - Optional selector to match the nodes to
* @return {Array} Array containing matched nodes
*/
conditioner.getNodesAll(selector);{% endhighlight %}


        </section>


        <section>

            <h3 class="code" id="node">Node</h3>

            <p>For each element found having a <code>data-module</code> attribute an object of type Node is made. The node object can then be queried for the ModuleControllers it contains.</p>

            <nav class="sub code">
                <ul>
                    <li><a href="#node-get-active-module-controller">getActiveModuleController</a> &rarr; <a href="#module-controller">ModuleController</a> | null</li>
                    <li><a href="#node-get-module-controller-by-path">getModuleControllerByPath</a> &rarr; <a href="#module-controller">ModuleController</a> | null</li>
                    <li><a href="#node-get-module-controller-all-by-path">getModuleControllersByPath</a> &rarr; Array</li>
                    <li><a href="#node-matches-selector">matchesSelector</a> &rarr; boolean</li>
                    <li><a href="#node-execute">execute</a> &rarr; object</li>
                </ul>
            </nav>

            <h4 class="code" id="node-get-active-module-controller">getActiveModuleController</h4>
            <p>Returns a reference to the currently active ModuleController.</p>
{% highlight javascript %}/**
* Returns a reference to the currently active module controller
* @return {ModuleController}
* @public
*/
node.getActiveModuleController();{% endhighlight %}


            <h4 class="code" id="node-get-module-controller-by-path">getModuleControllerByPath</h4>
            <p>Finds and returns the first module to match the supplied path.</p>
{% highlight javascript %}/**
* Returns the first module controller matching the given path
* @param path {string} path to module
* @return {ModuleController}
* @public
*/
node.getModuleControllerByPath(path);{% endhighlight %}


            <h4 class="code" id="node-get-module-controller-all-by-path">getModuleControllerAllByPath</h4>
            <p>Finds all ModuleControllers matching the supplied path and returns them as an array.</p>
{% highlight javascript %}/**
* Returns an array of ModuleControllers matching the given path
* @param path {string} path to module
* @return {Array}
* @public
*/
node.getModuleControllerAllByPath(path);{% endhighlight %}


            <h4 class="code" id="node-matches-selector">matchesSelector</h4>
            <p>Tests if the element contained in the Node object matches the supplied CSS selector.</p>
{% highlight javascript %}/**
* Public method to check if the module matches the given query
* @param {string} selector
* @return {boolean}
* @public
*/
node.matchesSelector(selector);{% endhighlight %}


            <h4 class="code" id="node-execute">execute</h4>
            <p>Safely tries to executes a method on the currently active Module. Always returns an object containing a status code and a response data property.</p>
{% highlight javascript %}/**
* Public method for safely executing methods on the loaded module
* @param {string} method - method key
* @param {Array} params - array containing the method parameters
* @return {object} returns object containing status code and possible response data
* @public
*/
node.execute(method,[params]);{% endhighlight %}

        </section>




        <section>

            <h3 class="code" id="module-controller">ModuleController</h3>

            <p>The ModuleController loads and unloads the contained Module based on the conditions received. It propagates events from the contained Module so you can safely subscribe to them.</p>
            <nav class="sub code">
                <ul>
                    <li><a href="#module-controller-matches-path">matchesPath</a> &rarr; boolean</li>
                    <li><a href="#module-controller-is-active">isActive</a> &rarr; boolean</li>
                    <li><a href="#module-controller-load">load</a></li>
                    <li><a href="#module-controller-unload">unload</a> &rarr; boolean</li>
                    <li><a href="#module-controller-execute">execute</a> &rarr; object</li>
                </ul>
            </nav>

        <h4 class="code" id="module-controller-matches-path">matchesPath</h4>
        <p>Returns true if the ModuleController is in charge of a module with the given path.</p>
{% highlight javascript %}/**
* Checks if the module matches the path
* @param {string} path - path of module to test for
* @return {boolean} if matched
* @public
*/
moduleController.matchesPath(path);{% endhighlight %}

        <h4 class="code" id="module-controller-is-active">isActive</h4>
        <p>Returns true if the module contained within the ModuleController is currently loaded.</p>
{% highlight javascript %}/**
* Returns true if module is currently active and loaded
* @returns {boolean}
* @public
*/
moduleController.isActive();{% endhighlight %}

        <h4 class="code" id="module-controller-load">load</h4>
        <p>Loads the Module if it's available (if conditions suitable). Publishes the 'load' event once finished.</p>
{% highlight javascript %}/**
* Load the module contained in this ModuleController
* @public
* @fires load
*/
moduleController.load();{% endhighlight %}

        <h4 class="code" id="module-controller-unload">unload</h4>
        <p>Unloads the Module if it's not already unloaded. Publishes the 'unload' event once done.</p>
{% highlight javascript %}/**
* Unloads the Module
* @fires unload
* @return {boolean}
* @public
*/
moduleController.unload();{% endhighlight %}

        <h4 class="code" id="module-controller-execute">execute</h4>
        <p>Safely tries to execute a method on the module contained within the ModuleController.</p>
{% highlight javascript %}/**
* Executes a methods on the loaded module
* @param {string} method - method key
* @param {Array} params - optional array containing the method parameters
* @return {object} containing response of executed method and a status code
* @public
*/
moduleController.execute(method,[params]);{% endhighlight %}

    </section>

</section>