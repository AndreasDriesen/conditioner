<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">

        <title>Conditioner Demo</title>

        <link href="css/rainbow/github.css" rel="stylesheet">
        <link href="css/styles.css" rel="stylesheet">

        <script src="js/lib/require.js"></script>

    </head>
    <body>

        <h1>Conditioner Demo</h1>
        
        <h2>Setup</h2>




        <h3>HTML Attributes</h3>

        <p>You can link behavior to your DOM nodes using the <code>data-behavior</code> attribute.</p>

        <h4>data-behavior</h4>
        <p>The string contained in the <code>data-behavior</code> attribute points to the concrete implementation of the Class. For <code>IClock</code> this would be <code>ui.Clock</code>.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock"&gt; ... &lt;/div&gt;</code></pre>

        <h4>data-conditions</h4>
        <p>The conditions attributes allows you to control the conditions under which behavior is loaded. For instance, below is an example condition which triggers the behavior once the window is at least 450 pixels wide.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-conditions='{"window":{"min-width":450}}'&gt; ... &lt;/div&gt;</code></pre>

        <h4>data-options</h4>
        <p>The options attribute allows you to set specific options for the behavior, these options are then passed to the behavior constructor the moment the Class is initialized.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-options='{"time":false}'&gt; ... &lt;/div&gt;</code></pre>

        <h4>data-priority</h4>
        <p>The priority attributes allows you to control the order in which behavior is loaded. Positive numbers give a node priority over other nodes, a negative number moves it to the back of the line.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-priority="1"&gt; ... &lt;/div&gt;</code></pre>




        <h3>Javascript Kickoff</h3>

        <p>To initiate the <code>Conditioner</code> request an instance and have it <code>applyBehavior</code> to the document scope.</p>

        <pre><code data-language="javascript">// get instance of conditioner
var demo = Conditioner.getInstance();

// register concrete classes
demo.registerDependencies(
    {
        'id':'IClock',
        'uri':'ui.Clock'
    }
);

// wait till dom ready
document.addEventListener('DOMContentLoaded',function() {
    demo.applyBehavior(document);
},false);</code></pre>



        <h2>Examples</h2>

        <h3>Always enabled</h3>
        <p>Clock will be always be active.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock"&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock">Clock is inactive</div>
        </div>


        <h3>Based on Element dimensions</h3>
        <p>Clock will be active as long as the element has a minimum width of 350px.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-conditions='{"element":{"minWidth":350}}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component" style="width:50.00%">
            <div data-behavior="IClock" data-conditions='{"element":{"min-width":350}}'>Clock is inactive</div>
        </div>


        <h3>Based on multiple window dimensions</h3>
        <p>Clock will be active as long as window width falls between 450px and 750px. Priority of this component has a value of 1 which causes it to be loaded before all default components.</p>
        <pre><code data-language="html">&lt;div data-priority="1" data-conditions='{"window":{"minWidth":450,"maxWidth":750}}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock" data-priority="1" data-conditions='{"window":{"min-width":450,"max-width":750}}'>Clock is inactive</div>
        </div>


        <h3>Based on Media Query</h3>
        <p>Clock will be active as long as media the media query is matched. Priority of this component has a value of minus 1, which causes it to be loaded after all other components have loaded.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-priority="-1" data-conditions='{"mediaquery":"(min-width:30em) and (max-width:40em)"}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock" data-priority="-1" data-conditions='{"mediaquery":"(min-width:30em) and (max-width:40em)"}'>Clock is inactive</div>
        </div>


        <h3>Based on the availability of a pointer device</h3>
        <p>Clock will be active as long as we can detect the user has a pointer device.</p>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-conditions='{"pointer":true}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock" data-conditions='{"pointer":true}'>Clock is inactive</div>
        </div>



        <h3>Based on multiple conditions</h3>
        <p>Map will be active as long as there is a network connection and the media query (min-width:40em) is matched. The Map javascript file has not been included as a script reference and will only be loaded once the conditions are met.</p>
        <pre><code data-language="html">&lt;div data-behavior="IMap" data-priority="2" data-conditions='{"connection":"any","mediaquery":"(min-width:40em)"}'&gt;Map is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IMap" data-priority="2" data-conditions='{"connection":"any","mediaquery":"(min-width:40em)"}'>Map is inactive</div>
        </div>


        <h3>Multiple Behavior Classes on a single element</h3>
        <p>Date will be active as long as element has a maximum width of 300px, if the element width gets above 400px the Clock becomes active.</p>
        <pre><code data-language="html">&lt;div data-behavior='["IClock","IClock"]' data-conditions='[{"element":{"maxWidth":300}},{"element":{"minWidth":400}}]' data-options='[{"time":false},{"time":true}]' data-priority="[1,2]"&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component" style="width:50.00%">
            <div data-behavior='["IClock","IClock"]' data-conditions='[{"element":{"max-width":300}},{"element":{"min-width":400}}]' data-options='[{"time":false},{"time":true}]' data-priority="[1,2]">Clock is inactive</div>
        </div>


        <h3>Based on custom conditions</h3>
        <p>Clock will be activated the moment cookies are allowed.</p>
        <pre><code data-language="html">&lt;div data-behavior="IStorageConsent" data-options='{"label":{"select":"Allow cookies"}}'&gt;Javascript needs to be enabled to control storage settings&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IStorageConsent" data-options='{"label":{"select":"Allow cookies"}}'>
                Javascript needs to be enabled to control storage settings
            </div>
        </div>
        <pre><code data-language="html">&lt;div data-behavior="IClock" data-conditions='{"cookies":["all"]}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock" data-conditions='{"cookies":["all"]}'>Clock is inactive</div>
        </div>

        <pre><code data-language="html">&lt;div data-behavior="IClock" data-conditions='{"cookies":["all","incognito"]}'&gt;Clock is inactive&lt;/div&gt;</code></pre>
        <div class="component">
            <div data-behavior="IClock" data-conditions='{"cookies":["all","incognito"]}'>Clock is inactive</div>
        </div>



        <!-- Shims to get this working on older browsers -->
        <script src="js/shim/JSON.js"></script>
        <script src="js/shim/ContentLoaded.js"></script>
        <script src="js/shim/EventListener.js"></script>
        <script src="js/shim/IndexOf.js"></script>
        <script src="js/shim/Object.create.js"></script>
        <script src="js/shim/Bind.js"></script>
        <script src="js/shim/matchMedia/matchMedia.js"></script>
        <script src="js/shim/matchMedia/matchMedia.addListener.js"></script>

        <!-- make demo code pretty -->
        <script src="js/lib/rainbow/rainbow.min.js"></script>
        <script src="js/lib/rainbow/html.js"></script>
        <script src="js/lib/rainbow/generic.js"></script>
        <script src="js/lib/rainbow/javascript.js"></script>

        <script>

            // set requirejs default options
            requirejs.config({
                baseUrl: 'js',
                paths:{
                    'conditioner':'../../src/conditioner'
                }
            });

            // load Conditioner and default set of Tests
            requirejs(['conditioner/Conditioner'],

                function(Conditioner){

                // get instance of conditioner
                var demo = Conditioner.getInstance();

                // register modules
                demo.registerDependencies(
                    {
                        'id':'IMap',
                        'path':'ui/Map'
                    },
                    {
                        'id':'IClock',
                        'path':'ui/Clock'
                    },
                    {
                        'id':'IStorageConsent',
                        'path':'ui/StorageConsentSelect',
                        'options':{
                            'label':{
                                'level':{
                                    'incognito':'Incognito'
                                }
                            }
                        }
                    },
                    {
                        'id':'IStorageGuard',
                        'path':'security/StorageConsentGuard',
                        'options':{
                            'levels':['all','incognito','none'],
                            'initial':'none'
                        }
                    }
                );

                // register custom cookie test
                demo.registerTests({
                    'id':'cookies',
                    'path':'./tests/Cookies'
                });

                // apply behavior to document scope
                demo.applyBehavior(document);

            });


        </script>
    </body>
</html>
