<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">

        <title>Conditioner Demo</title>

        <link href="css/rainbow/github.css" rel="stylesheet">
        <link href="css/styles.css" rel="stylesheet">

    </head>
    <body>

        <h1>Conditioner Demo</h1>

        <h2>Introduction</h2>
        <p>Conditioner is a JavaScript framework based on <a href="http://requirejs.org">RequireJS</a>, it allows you to conditionally load your javascript modules based on certain environment requirements.</p>

        <p>Suppose you have a Google Maps module which transforms an anchor to a full blown Google Map.</p>

        <p>It would make sense to only activate the maps module if there's enough real estate on the screen to render a decent sized map.</p>

        <p>An example setup using Conditioner:</p>

        <pre><code data-language="html">&lt;div data-module="ui/Map" data-conditions="media:{(min-width:30em)}"&gt; ... &lt;/div&gt;</code></pre>

        <p>Conditioner initialisation:</p>

        <pre><code data-language="javascript">conditioner.loadModules(document);</code></pre>


        <h2>Examples</h2>

        <h3>Always enabled</h3>
        <p>Clock will be always be active.</p>
        <pre><code data-language="html">&lt;div data-module="IClock"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock">Clock is inactive</div>
        </div>


        <h3>Based on Element dimensions</h3>
        <p>Clock will be active as long as the element has a minimum width of 350 pixels.</p>
        <pre><code data-language="html">&lt;div data-module="IClock" data-conditions="element:{min-width:350}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component alt">
            <div data-module="IClock"
                 data-conditions="element:{min-width:350}">Clock is inactive</div>
        </div>


        <h3>Based on multiple window dimensions</h3>
        <p>Clock will be active as long as window width falls between 450 and 750 pixels. Priority of this component has a value of 1 which causes it to be loaded before all components without and explicit priority.</p>
        <pre><code data-language="html">&lt;div data-module="IClock" data-conditions="window:{min-width:450} and window:{max-width:750}" data-priority="1"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock"
                 data-priority="1"
                 data-conditions="window:{min-width:450} and window:{max-width:750}">Clock is inactive</div>
        </div>


        <h3>Based on Media Query</h3>
        <p>Clock will be active as long as media the media query is matched. Priority of this component has a value of minus 1, which causes it to be loaded after all components without and explicit priority have loaded.</p>
        <pre><code data-language="html">&lt;div data-module="IClock" data-priority="-1" data-conditions="media:{(min-width:30em) and (max-width:60em)} or not media:{supported}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock"
                 data-priority="-1"
                 data-conditions="media:{(min-width:30em) and (max-width:60em)} or not media:{supported}">Clock is inactive</div>
        </div>

        <h3>Based on the availability of a pointer device</h3>
        <p>Clock will be active as long as we can detect the user has a pointer device.</p>
        <pre><code data-language="html">&lt;div data-module="IClock" data-conditions="pointer:{available}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock"
                 data-conditions="pointer:{available}">Clock is inactive</div>
        </div>


        <h3>Based on multiple conditions</h3>
        <p>Map will be active as long as there is any network connection, the media query is matched and the element is in view. If there is no media query support, the map may also be loaded.</p>
        <pre><code data-language="html">&lt;div data-module="IMap" data-priority="2" data-conditions="(connection:{any} and media:{(min-width:40em)} and element:{seen}) or not media:{supported}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IMap"
                 data-priority="2"
                 data-conditions="(connection:{any} and media:{(min-width:40em)} and element:{seen}) or not media:{supported}">Map is inactive</div>
        </div>


        <h3>Based on custom conditions</h3>
        <p>The first Clock will be activated the moment all cookies are allowed. The second Clock is only inactive when the user accepts no cookies.</p>
        <pre><code data-language="html">&lt;div data-module="IStorageConsentSelect" data-options='{"label":{"select":"Allow cookies"}}'&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IStorageConsentSelect"
                 data-options='{"label":{"select":"Allow cookies"}}'>
                Javascript needs to be enabled to control storage settings
            </div>
        </div>
        <pre><code data-language="html">&lt;div data-module="IClock" data-conditions="cookies:{all}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock"
                 data-conditions="cookies:{all}">Clock is inactive</div>
        </div>
        <pre><code data-language="html">&lt;div data-module="IClock" data-conditions="cookies:{all,incognito}"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component">
            <div data-module="IClock"
                 data-conditions="cookies:{all,incognito}">Clock is inactive</div>
        </div>


        <h3>Multiple modules on a single element</h3>
        <p>Clock will be active as long as element has a maximum width of 300 pixels, if the element width gets above 400 pixels another Clock becomes active which also shows the time.</p>
        <pre><code data-language="html">&lt;div data-module='[{"path":"IClock","conditions":"element:{max-width:300}","options":{"time":false}},{"path":"IClock","conditions":"element:{min-width:400}"}]' data-priority="1"&gt; ... &lt;/div&gt;</code></pre>
        <div class="component alt">
            <div data-module='[{"path":"IClock","conditions":"element:{max-width:300}","options":{"time":false}},{"path":"IClock","conditions":"element:{min-width:400}"}]' data-priority="1">Clock is inactive</div>
        </div>


        <h3>Using a conditioned and a wildcard module on a single element</h3>
        <p>Clock will be active as long as element has a maximum width of 300 pixels, if the element gets above 300 pixels the wildcard Clock element is loaded which shows the time.</p>
        <pre><code data-language="html">&lt;div data-module='[{"path":"IClock","conditions":"element:{max-width:300}","options":{"time":false}},{"path":"IClock"}]'&gt; ... &lt;/div&gt;</code></pre>
        <div class="component alt">
            <div data-module='[{"path":"IClock","conditions":"element:{max-width:300}","options":{"time":false}},{"path":"IClock"}]'>Clock is inactive</div>
        </div>


        <!-- For pretty javascript code examples -->
        <script src="js/lib/ccampbell/rainbow/rainbow.min.js"></script>
        <script src="js/lib/ccampbell/rainbow/html.js"></script>
        <script src="js/lib/ccampbell/rainbow/generic.js"></script>
        <script src="js/lib/ccampbell/rainbow/javascript.js"></script>


        <!-- Shims to get this working on some older browsers <= IE9 (please minimize in real life) -->
        <script src="js/shim/Array.isArray.js"></script>
        <script src="js/shim/Array.indexOf.js"></script>
        <script src="js/shim/Array.forEach.js"></script>
        <script src="js/shim/Object.create.js"></script>
        <script src="js/shim/Object.keys.js"></script>
        <script src="js/shim/Function.bind.js"></script>
        <script src="js/shim/matchMedia/matchMedia.js"></script>
        <script src="js/shim/matchMedia/matchMedia.addListener.js"></script>

        <!-- old stuff last, matchmedia won't be loaded if browser does not have addEventListener support, so we'll load shim now -->
        <script src="js/shim/DOMContentLoaded.js"></script>
        <script src="js/shim/addEventListener.js"></script>

        <!-- Load minimized library (require + modules)
        <script src="js.min/built.js"></script> -->

        <script src="js/lib/jrburke/require.js"></script>


        <script>

        // setup requirejs
        requirejs.config({
            baseUrl:'js/',
            paths:{
                conditioner:'../../dist/conditioner'
            }
        });

        // load conditioner
        requirejs(['conditioner'],function(conditioner) {

                // setup modules
                conditioner.setOptions({
                    'modules':{
                        'ui/Map':'IMap',
                        'ui/Clock':'IClock',
                        'ui/StorageConsentSelect':{
                            'alias':'IStorageConsentSelect',
                            'options':{
                                'label':{
                                    'level':{
                                        'incognito':'Incognito'
                                    }
                                }
                            }
                        },
                        'security/StorageConsentGuard':{
                            'options':{
                                'levels':['all','incognito','none'],
                                'initial':'none'
                            }
                        }
                    }
                });

                // load all modules found within the document scope
                conditioner.loadModules(document);

            }

        );

        </script>

    </body>
</html>